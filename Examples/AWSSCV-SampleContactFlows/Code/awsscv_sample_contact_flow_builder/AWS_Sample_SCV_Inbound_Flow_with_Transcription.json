{"modules":[{"id":"a2e856a6-b552-40be-a599-9f77fd6eb79a","type":"SetLoggingBehavior","branches":[{"condition":"Success","transition":"fc899ff7-c46a-452b-939c-33e5e520c9a2"}],"parameters":[{"name":"LoggingBehavior","value":"Enable"}],"metadata":{"position":{"x":24.366668701171875,"y":181}}},{"id":"8cc61213-dbb6-4ed4-b86e-00d043a4ecd6","type":"PlayPrompt","branches":[{"condition":"Success","transition":"a355c649-31f7-4080-b6e1-69b0f8f38163"}],"parameters":[{"name":"Text","value":"Transferring to Customer Support....","namespace":null},{"name":"TextToSpeechType","value":"text"}],"metadata":{"position":{"x":3522,"y":100},"useDynamic":false}},{"id":"9a140a86-ac4d-4583-950c-29c7fcf5791d","type":"PlayPrompt","branches":[{"condition":"Success","transition":"ed704d14-0a7a-481f-8433-ae2737298ab2"}],"parameters":[{"name":"Text","value":"I'm sorry. We have encountered an error and cannot currently handle your call. Please try back later. We apologize for any inconvenience. Goodbye.","namespace":null},{"name":"TextToSpeechType","value":"text"}],"metadata":{"position":{"x":2243.633331298828,"y":376},"useDynamic":false}},{"id":"ed704d14-0a7a-481f-8433-ae2737298ab2","type":"Disconnect","branches":[],"parameters":[],"metadata":{"position":{"x":2483.633331298828,"y":374}}},{"id":"283ba344-b7f8-4493-bddd-a6d243b14ba8","type":"SetAttributes","branches":[{"condition":"Success","transition":"a36f4066-a2a9-4c0e-8047-9cdb428ea4e9"},{"condition":"Error","transition":"38305b2c-ffde-4811-9c77-28971cf722fc"}],"parameters":[{"name":"Attribute","value":"voiceCallId","key":"voiceCallId","namespace":"External"}],"metadata":{"position":{"x":2974,"y":103}}},{"id":"a355c649-31f7-4080-b6e1-69b0f8f38163","type":"Transfer","branches":[{"condition":"AtCapacity","transition":"5fdb094d-aee2-4ea6-8e55-d257af32ecb5"},{"condition":"Error","transition":"1a2ac491-46e6-4b57-b240-8386dea00a30"}],"parameters":[],"metadata":{"position":{"x":3797,"y":99},"useDynamic":false,"queue":null},"target":"Queue"},{"id":"a36f4066-a2a9-4c0e-8047-9cdb428ea4e9","type":"SetQueue","branches":[{"condition":"Success","transition":"8cc61213-dbb6-4ed4-b86e-00d043a4ecd6"},{"condition":"Error","transition":"5a06a301-de90-4c6b-96cb-78f3645a6aa9"}],"parameters":[{"name":"Queue","value":"Sample","namespace":"User Defined","resourceName":null}],"metadata":{"position":{"x":3249,"y":102},"useDynamic":true,"queue":"Sample"}},{"id":"5fdb094d-aee2-4ea6-8e55-d257af32ecb5","type":"SetAttributes","branches":[{"condition":"Success","transition":"6e346866-f534-41dd-a7f8-1185143f6471"},{"condition":"Error","transition":"6e346866-f534-41dd-a7f8-1185143f6471"}],"parameters":[{"name":"Attribute","value":"queue limite exceeded","key":"error_desc","namespace":null},{"name":"Attribute","value":"true","key":"process_error","namespace":null}],"metadata":{"position":{"x":4042.57666015625,"y":97.66091918945312}}},{"id":"38305b2c-ffde-4811-9c77-28971cf722fc","type":"SetAttributes","branches":[{"condition":"Success","transition":"88c4c809-af05-4960-8260-96d1a0cfe6c8"},{"condition":"Error","transition":"88c4c809-af05-4960-8260-96d1a0cfe6c8"}],"parameters":[{"name":"Attribute","value":"set voiceObjectId failed","key":"error_desc","namespace":null},{"name":"Attribute","value":"true","key":"process_error","namespace":null}],"metadata":{"position":{"x":3002.633331298828,"y":376}}},{"id":"1a2ac491-46e6-4b57-b240-8386dea00a30","type":"SetAttributes","branches":[{"condition":"Success","transition":"88c4c809-af05-4960-8260-96d1a0cfe6c8"},{"condition":"Error","transition":"88c4c809-af05-4960-8260-96d1a0cfe6c8"}],"parameters":[{"name":"Attribute","value":"transfer to queue failed","key":"error_desc","namespace":null},{"name":"Attribute","value":"true","key":"process_error","namespace":null}],"metadata":{"position":{"x":3798,"y":337}}},{"id":"5a06a301-de90-4c6b-96cb-78f3645a6aa9","type":"SetAttributes","branches":[{"condition":"Success","transition":"88c4c809-af05-4960-8260-96d1a0cfe6c8"},{"condition":"Error","transition":"88c4c809-af05-4960-8260-96d1a0cfe6c8"}],"parameters":[{"name":"Attribute","value":"set working queue failed","key":"error_desc","namespace":null},{"name":"Attribute","value":"true","key":"process_error","namespace":null}],"metadata":{"position":{"x":3335,"y":344}}},{"id":"6e346866-f534-41dd-a7f8-1185143f6471","type":"PlayPrompt","branches":[{"condition":"Success","transition":"b5886cf6-27dd-44d4-a958-a1cd084c3cb4"}],"parameters":[{"name":"Text","value":"We are experiencing a higher than normal call volume.  Please try back later. Sorry for the inconvenience.","namespace":null},{"name":"TextToSpeechType","value":"text"}],"metadata":{"position":{"x":4280,"y":98},"useDynamic":false}},{"id":"88c4c809-af05-4960-8260-96d1a0cfe6c8","type":"PlayPrompt","branches":[{"condition":"Success","transition":"b5886cf6-27dd-44d4-a958-a1cd084c3cb4"}],"parameters":[{"name":"Text","value":"I'm sorry. We have encountered an error and cannot currently handle your call. Please try back later. We apologize for any inconvenience. Goodbye.","namespace":null},{"name":"TextToSpeechType","value":"text"}],"metadata":{"position":{"x":3580.633331298828,"y":557},"useDynamic":false}},{"id":"b5886cf6-27dd-44d4-a958-a1cd084c3cb4","type":"Disconnect","branches":[],"parameters":[],"metadata":{"position":{"x":4355.633331298828,"y":433}}},{"id":"48e75255-35a6-49e7-9038-7a76525e9227","type":"SetAttributes","branches":[{"condition":"Success","transition":"9a140a86-ac4d-4583-950c-29c7fcf5791d"},{"condition":"Error","transition":"9a140a86-ac4d-4583-950c-29c7fcf5791d"}],"parameters":[{"name":"Attribute","value":"lambda loop fail","key":"error_desc","namespace":null},{"name":"Attribute","value":"true","key":"process_error","namespace":null}],"metadata":{"position":{"x":1997.6333312988281,"y":377}}},{"id":"af89b7be-14c3-40e7-a9ab-643748abe7ec","type":"InvokeExternalResource","branches":[{"condition":"Success","transition":"283ba344-b7f8-4493-bddd-a6d243b14ba8"},{"condition":"Error","transition":"afb3e3e1-3740-48d9-9588-1cdb3c4720bf"}],"parameters":[{"name":"FunctionArn","value":"arn:aws:lambda:us-west-2:376407789201:function:SCV08112020-InvokeTelephonyIntegrationApiFunction","namespace":null},{"name":"TimeLimit","value":"3"},{"name":"Parameter","key":"methodName","value":"createVoiceCall","namespace":null}],"metadata":{"position":{"x":2721.633331298828,"y":475},"dynamicMetadata":{"methodName":false},"useDynamic":false},"target":"Lambda"},{"id":"fc899ff7-c46a-452b-939c-33e5e520c9a2","type":"SetRecordingBehavior","branches":[{"condition":"Success","transition":"18abf7ed-d8b3-4163-8e77-052303abefcd"}],"parameters":[{"name":"RecordingBehaviorOption","value":"Disable"},{"name":"RecordingParticipantOption","value":"Both"}],"metadata":{"position":{"x":25.366668701171875,"y":362}}},{"id":"18abf7ed-d8b3-4163-8e77-052303abefcd","type":"SetAttributes","branches":[{"condition":"Success","transition":"3bab1bd5-5272-47fe-992f-d7c4ca26c097"},{"condition":"Error","transition":"3bab1bd5-5272-47fe-992f-d7c4ca26c097"}],"parameters":[{"name":"Attribute","value":"en-US","key":"languageCode","namespace":null},{"name":"Attribute","value":"1","key":"sfdc-RTT_flag__c","namespace":null}],"metadata":{"position":{"x":28.894468307495117,"y":547.47412109375}}},{"id":"3bab1bd5-5272-47fe-992f-d7c4ca26c097","type":"StartMediaStreaming","branches":[{"condition":"Success","transition":"817738cb-2e38-40d3-b2b8-98d4165a4f40"},{"condition":"Error","transition":"e89d54bd-f141-444f-8903-dce4f20b2d04"}],"parameters":[{"name":"Track","value":"FromCustomer"},{"name":"Track","value":"ToCustomer"},{"name":"MediaStreamTypes","value":"Audio"}],"metadata":{"position":{"x":287.6005554199219,"y":84.4700927734375},"fromCustomer":true,"toCustomer":true}},{"id":"e89d54bd-f141-444f-8903-dce4f20b2d04","type":"SetAttributes","branches":[{"condition":"Success","transition":"817738cb-2e38-40d3-b2b8-98d4165a4f40"},{"condition":"Error","transition":"817738cb-2e38-40d3-b2b8-98d4165a4f40"}],"parameters":[{"name":"Attribute","value":"kvs init failed","key":"error_desc","namespace":null},{"name":"Attribute","value":"true","key":"process_error","namespace":null},{"name":"Attribute","value":"0","key":"sfdc-RTT_flag__c","namespace":null}],"metadata":{"position":{"x":563,"y":325}}},{"id":"0b20602c-1008-4f55-b415-6a39a2624634","type":"SetAttributes","branches":[{"condition":"Success","transition":"afb3e3e1-3740-48d9-9588-1cdb3c4720bf"},{"condition":"Error","transition":"afb3e3e1-3740-48d9-9588-1cdb3c4720bf"}],"parameters":[{"name":"Attribute","value":"trigger function failed","key":"error_desc","namespace":null},{"name":"Attribute","value":"true","key":"process_error","namespace":null},{"name":"Attribute","value":"0","key":"sfdc-RTT_flag__c","namespace":null}],"metadata":{"position":{"x":1494,"y":327}}},{"id":"afb3e3e1-3740-48d9-9588-1cdb3c4720bf","type":"Loop","branches":[{"condition":"Looping","transition":"af89b7be-14c3-40e7-a9ab-643748abe7ec"},{"condition":"Complete","transition":"48e75255-35a6-49e7-9038-7a76525e9227"}],"parameters":[{"name":"LoopCount","value":"2"}],"metadata":{"position":{"x":1939.6333312988281,"y":101},"useDynamic":false}},{"id":"bfd1aa01-f94a-4f57-9e4a-30a92180be6c","type":"InvokeExternalResource","branches":[{"condition":"Success","transition":"afb3e3e1-3740-48d9-9588-1cdb3c4720bf"},{"condition":"Error","transition":"0b20602c-1008-4f55-b415-6a39a2624634"}],"parameters":[{"name":"FunctionArn","value":"arn:aws:lambda:us-west-2:376407789201:function:SCV08112020-kvsConsumerTrigger","namespace":null},{"name":"TimeLimit","value":"3"}],"metadata":{"position":{"x":1291,"y":81},"dynamicMetadata":{},"useDynamic":false},"target":"Lambda"},{"id":"817738cb-2e38-40d3-b2b8-98d4165a4f40","type":"PlayPrompt","branches":[{"condition":"Success","transition":"f785273b-e449-4b0e-87dc-10c02a2ea11a"}],"parameters":[{"name":"Text","value":"Thank you for calling. All calls may be monitored for quality assurance.","namespace":null},{"name":"TextToSpeechType","value":"text"}],"metadata":{"position":{"x":729,"y":85},"useDynamic":false}},{"id":"f785273b-e449-4b0e-87dc-10c02a2ea11a","type":"CheckAttribute","branches":[{"condition":"NoMatch","transition":"afb3e3e1-3740-48d9-9588-1cdb3c4720bf"},{"condition":"Evaluate","conditionType":"Equals","conditionValue":"1","transition":"bfd1aa01-f94a-4f57-9e4a-30a92180be6c"}],"parameters":[{"name":"Attribute","value":"sfdc-RTT_flag__c"},{"name":"Namespace","value":"User Defined"}],"metadata":{"position":{"x":1005.5963134765625,"y":84.4700927734375},"conditionMetadata":[{"id":"dc8b2975-0a50-4967-a7fd-98f03f76c041","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"1"}]}}],"version":"1","type":"contactFlow","start":"a2e856a6-b552-40be-a599-9f77fd6eb79a","metadata":{"entryPointPosition":{"x":15,"y":15},"snapToGrid":false,"name":"AWS_Sample_SCV_Inbound_Flow_with_Transcription","description":"Modified from: Sample_SCV_Inbound - Expands on the default Salesforce version by adding a loop around the Telephony Integration Lambda. Also provides error messaging which allows you to better report on these events and track them in CloudWatch logs","type":"contactFlow","status":"saved","hash":"3084aff6ab5c4be0a72d09f26f629284a75cb6e6a4133d660425a493b65e86bc"}}