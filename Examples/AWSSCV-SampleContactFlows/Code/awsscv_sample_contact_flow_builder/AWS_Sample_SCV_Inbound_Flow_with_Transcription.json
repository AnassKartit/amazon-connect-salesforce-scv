{
  "ContactFlow": {
    "Arn": "arn:aws:connect:us-west-2:267080358243:instance/f4b9b842-7906-4109-a90b-631ae751a89c/contact-flow/b191170d-8178-4ac3-adfb-48b23587bd62",
    "Id": "b191170d-8178-4ac3-adfb-48b23587bd62",
    "Name": "AWS_Sample_SCV_Inbound_Flow_with_Transcription",
    "Type": "CONTACT_FLOW",
    "Description": "Modified from: Sample_SCV_Inbound - Expands on the default Salesforce version by adding a loop around the Telephony Integration Lambda. Also provides error messaging which allows you to better report on these events and track them in CloudWatch logs",
    "Content": "{\"Version\":\"2019-10-30\",\"StartAction\":\"a2e856a6-b552-40be-a599-9f77fd6eb79a\",\"Metadata\":{\"entryPointPosition\":{\"x\":15,\"y\":15},\"snapToGrid\":false,\"ActionMetadata\":{\"a2e856a6-b552-40be-a599-9f77fd6eb79a\":{\"position\":{\"x\":24.366668701171875,\"y\":181}},\"8cc61213-dbb6-4ed4-b86e-00d043a4ecd6\":{\"position\":{\"x\":3522,\"y\":100},\"useDynamic\":false},\"9a140a86-ac4d-4583-950c-29c7fcf5791d\":{\"position\":{\"x\":2243.633331298828,\"y\":376},\"useDynamic\":false},\"ed704d14-0a7a-481f-8433-ae2737298ab2\":{\"position\":{\"x\":2483.633331298828,\"y\":374}},\"a355c649-31f7-4080-b6e1-69b0f8f38163\":{\"position\":{\"x\":3797,\"y\":99},\"useDynamic\":false},\"a36f4066-a2a9-4c0e-8047-9cdb428ea4e9\":{\"position\":{\"x\":3249,\"y\":102},\"useDynamic\":true,\"queue\":\"Sample\"},\"5fdb094d-aee2-4ea6-8e55-d257af32ecb5\":{\"position\":{\"x\":4042.57666015625,\"y\":97.66091918945312}},\"38305b2c-ffde-4811-9c77-28971cf722fc\":{\"position\":{\"x\":3002.633331298828,\"y\":376}},\"1a2ac491-46e6-4b57-b240-8386dea00a30\":{\"position\":{\"x\":3798,\"y\":337}},\"5a06a301-de90-4c6b-96cb-78f3645a6aa9\":{\"position\":{\"x\":3335,\"y\":344}},\"6e346866-f534-41dd-a7f8-1185143f6471\":{\"position\":{\"x\":4280,\"y\":98},\"useDynamic\":false},\"88c4c809-af05-4960-8260-96d1a0cfe6c8\":{\"position\":{\"x\":3580.633331298828,\"y\":557},\"useDynamic\":false},\"b5886cf6-27dd-44d4-a958-a1cd084c3cb4\":{\"position\":{\"x\":4355.633331298828,\"y\":433}},\"48e75255-35a6-49e7-9038-7a76525e9227\":{\"position\":{\"x\":1997.6333312988281,\"y\":377}},\"fc899ff7-c46a-452b-939c-33e5e520c9a2\":{\"position\":{\"x\":25.366668701171875,\"y\":362}},\"18abf7ed-d8b3-4163-8e77-052303abefcd\":{\"position\":{\"x\":28.894468307495117,\"y\":547.47412109375}},\"3bab1bd5-5272-47fe-992f-d7c4ca26c097\":{\"position\":{\"x\":287.6005554199219,\"y\":84.4700927734375},\"fromCustomer\":true,\"toCustomer\":true},\"e89d54bd-f141-444f-8903-dce4f20b2d04\":{\"position\":{\"x\":563,\"y\":325}},\"817738cb-2e38-40d3-b2b8-98d4165a4f40\":{\"position\":{\"x\":729,\"y\":85},\"useDynamic\":false},\"0b20602c-1008-4f55-b415-6a39a2624634\":{\"position\":{\"x\":1494,\"y\":327}},\"f785273b-e449-4b0e-87dc-10c02a2ea11a\":{\"position\":{\"x\":1005.5963134765625,\"y\":84.4700927734375},\"conditionMetadata\":[{\"id\":\"96cbf58f-8a1c-4b58-9df1-248deb6a21d1\",\"operator\":{\"name\":\"Equals\",\"value\":\"Equals\",\"shortDisplay\":\"=\"},\"value\":\"1\"}]},\"bfd1aa01-f94a-4f57-9e4a-30a92180be6c\":{\"position\":{\"x\":1291,\"y\":81},\"dynamicMetadata\":{},\"useDynamic\":false},\"283ba344-b7f8-4493-bddd-a6d243b14ba8\":{\"position\":{\"x\":2974,\"y\":103}},\"afb3e3e1-3740-48d9-9588-1cdb3c4720bf\":{\"position\":{\"x\":1939.6333312988281,\"y\":101},\"useDynamic\":false},\"af89b7be-14c3-40e7-a9ab-643748abe7ec\":{\"position\":{\"x\":2721.633331298828,\"y\":475},\"dynamicMetadata\":{\"methodName\":false},\"useDynamic\":false}}},\"Actions\":[{\"Identifier\":\"a2e856a6-b552-40be-a599-9f77fd6eb79a\",\"Parameters\":{\"FlowLoggingBehavior\":\"Enabled\"},\"Transitions\":{\"NextAction\":\"fc899ff7-c46a-452b-939c-33e5e520c9a2\",\"Errors\":[],\"Conditions\":[]},\"Type\":\"UpdateFlowLoggingBehavior\"},{\"Identifier\":\"8cc61213-dbb6-4ed4-b86e-00d043a4ecd6\",\"Parameters\":{\"Text\":\"Transferring to Customer Support....\"},\"Transitions\":{\"NextAction\":\"a355c649-31f7-4080-b6e1-69b0f8f38163\",\"Errors\":[],\"Conditions\":[]},\"Type\":\"MessageParticipant\"},{\"Identifier\":\"9a140a86-ac4d-4583-950c-29c7fcf5791d\",\"Parameters\":{\"Text\":\"I'm sorry. We have encountered an error and cannot currently handle your call. Please try back later. We apologize for any inconvenience. Goodbye.\"},\"Transitions\":{\"NextAction\":\"ed704d14-0a7a-481f-8433-ae2737298ab2\",\"Errors\":[],\"Conditions\":[]},\"Type\":\"MessageParticipant\"},{\"Identifier\":\"ed704d14-0a7a-481f-8433-ae2737298ab2\",\"Type\":\"DisconnectParticipant\",\"Parameters\":{},\"Transitions\":{}},{\"Identifier\":\"a355c649-31f7-4080-b6e1-69b0f8f38163\",\"Transitions\":{\"NextAction\":\"1a2ac491-46e6-4b57-b240-8386dea00a30\",\"Errors\":[{\"NextAction\":\"1a2ac491-46e6-4b57-b240-8386dea00a30\",\"ErrorType\":\"NoMatchingError\"},{\"NextAction\":\"5fdb094d-aee2-4ea6-8e55-d257af32ecb5\",\"ErrorType\":\"QueueAtCapacity\"}],\"Conditions\":[]},\"Type\":\"TransferContactToQueue\"},{\"Identifier\":\"a36f4066-a2a9-4c0e-8047-9cdb428ea4e9\",\"Parameters\":{\"QueueId\":\"$.Attributes.Sample\"},\"Transitions\":{\"NextAction\":\"8cc61213-dbb6-4ed4-b86e-00d043a4ecd6\",\"Errors\":[{\"NextAction\":\"5a06a301-de90-4c6b-96cb-78f3645a6aa9\",\"ErrorType\":\"NoMatchingError\"}],\"Conditions\":[]},\"Type\":\"UpdateContactTargetQueue\"},{\"Identifier\":\"5fdb094d-aee2-4ea6-8e55-d257af32ecb5\",\"Parameters\":{\"Attributes\":{\"error_desc\":\"queue limite exceeded\",\"process_error\":\"true\"}},\"Transitions\":{\"NextAction\":\"6e346866-f534-41dd-a7f8-1185143f6471\",\"Errors\":[{\"NextAction\":\"6e346866-f534-41dd-a7f8-1185143f6471\",\"ErrorType\":\"NoMatchingError\"}],\"Conditions\":[]},\"Type\":\"UpdateContactAttributes\"},{\"Identifier\":\"38305b2c-ffde-4811-9c77-28971cf722fc\",\"Parameters\":{\"Attributes\":{\"error_desc\":\"set voiceObjectId failed\",\"process_error\":\"true\"}},\"Transitions\":{\"NextAction\":\"88c4c809-af05-4960-8260-96d1a0cfe6c8\",\"Errors\":[{\"NextAction\":\"88c4c809-af05-4960-8260-96d1a0cfe6c8\",\"ErrorType\":\"NoMatchingError\"}],\"Conditions\":[]},\"Type\":\"UpdateContactAttributes\"},{\"Identifier\":\"1a2ac491-46e6-4b57-b240-8386dea00a30\",\"Parameters\":{\"Attributes\":{\"error_desc\":\"transfer to queue failed\",\"process_error\":\"true\"}},\"Transitions\":{\"NextAction\":\"88c4c809-af05-4960-8260-96d1a0cfe6c8\",\"Errors\":[{\"NextAction\":\"88c4c809-af05-4960-8260-96d1a0cfe6c8\",\"ErrorType\":\"NoMatchingError\"}],\"Conditions\":[]},\"Type\":\"UpdateContactAttributes\"},{\"Identifier\":\"5a06a301-de90-4c6b-96cb-78f3645a6aa9\",\"Parameters\":{\"Attributes\":{\"error_desc\":\"set working queue failed\",\"process_error\":\"true\"}},\"Transitions\":{\"NextAction\":\"88c4c809-af05-4960-8260-96d1a0cfe6c8\",\"Errors\":[{\"NextAction\":\"88c4c809-af05-4960-8260-96d1a0cfe6c8\",\"ErrorType\":\"NoMatchingError\"}],\"Conditions\":[]},\"Type\":\"UpdateContactAttributes\"},{\"Identifier\":\"6e346866-f534-41dd-a7f8-1185143f6471\",\"Parameters\":{\"Text\":\"We are experiencing a higher than normal call volume.  Please try back later. Sorry for the inconvenience.\"},\"Transitions\":{\"NextAction\":\"b5886cf6-27dd-44d4-a958-a1cd084c3cb4\",\"Errors\":[],\"Conditions\":[]},\"Type\":\"MessageParticipant\"},{\"Identifier\":\"88c4c809-af05-4960-8260-96d1a0cfe6c8\",\"Parameters\":{\"Text\":\"I'm sorry. We have encountered an error and cannot currently handle your call. Please try back later. We apologize for any inconvenience. Goodbye.\"},\"Transitions\":{\"NextAction\":\"b5886cf6-27dd-44d4-a958-a1cd084c3cb4\",\"Errors\":[],\"Conditions\":[]},\"Type\":\"MessageParticipant\"},{\"Identifier\":\"b5886cf6-27dd-44d4-a958-a1cd084c3cb4\",\"Type\":\"DisconnectParticipant\",\"Parameters\":{},\"Transitions\":{}},{\"Identifier\":\"48e75255-35a6-49e7-9038-7a76525e9227\",\"Parameters\":{\"Attributes\":{\"error_desc\":\"lambda loop fail\",\"process_error\":\"true\"}},\"Transitions\":{\"NextAction\":\"9a140a86-ac4d-4583-950c-29c7fcf5791d\",\"Errors\":[{\"NextAction\":\"9a140a86-ac4d-4583-950c-29c7fcf5791d\",\"ErrorType\":\"NoMatchingError\"}],\"Conditions\":[]},\"Type\":\"UpdateContactAttributes\"},{\"Identifier\":\"fc899ff7-c46a-452b-939c-33e5e520c9a2\",\"Parameters\":{\"RecordingBehavior\":{\"RecordedParticipants\":[]}},\"Transitions\":{\"NextAction\":\"18abf7ed-d8b3-4163-8e77-052303abefcd\",\"Errors\":[],\"Conditions\":[]},\"Type\":\"UpdateContactRecordingBehavior\"},{\"Identifier\":\"18abf7ed-d8b3-4163-8e77-052303abefcd\",\"Parameters\":{\"Attributes\":{\"sfdc-RTT_flag__c\":\"1\",\"languageCode\":\"en-US\"}},\"Transitions\":{\"NextAction\":\"3bab1bd5-5272-47fe-992f-d7c4ca26c097\",\"Errors\":[{\"NextAction\":\"3bab1bd5-5272-47fe-992f-d7c4ca26c097\",\"ErrorType\":\"NoMatchingError\"}],\"Conditions\":[]},\"Type\":\"UpdateContactAttributes\"},{\"Identifier\":\"3bab1bd5-5272-47fe-992f-d7c4ca26c097\",\"Parameters\":{\"MediaStreamingState\":\"Enabled\",\"MediaStreamType\":\"Audio\",\"Participants\":[{\"ParticipantType\":\"Customer\",\"MediaDirections\":[\"From\",\"To\"]}]},\"Transitions\":{\"NextAction\":\"817738cb-2e38-40d3-b2b8-98d4165a4f40\",\"Errors\":[{\"NextAction\":\"e89d54bd-f141-444f-8903-dce4f20b2d04\",\"ErrorType\":\"NoMatchingError\"}],\"Conditions\":[]},\"Type\":\"UpdateContactMediaStreamingBehavior\"},{\"Identifier\":\"e89d54bd-f141-444f-8903-dce4f20b2d04\",\"Parameters\":{\"Attributes\":{\"error_desc\":\"kvs init failed\",\"sfdc-RTT_flag__c\":\"0\",\"process_error\":\"true\"}},\"Transitions\":{\"NextAction\":\"817738cb-2e38-40d3-b2b8-98d4165a4f40\",\"Errors\":[{\"NextAction\":\"817738cb-2e38-40d3-b2b8-98d4165a4f40\",\"ErrorType\":\"NoMatchingError\"}],\"Conditions\":[]},\"Type\":\"UpdateContactAttributes\"},{\"Identifier\":\"817738cb-2e38-40d3-b2b8-98d4165a4f40\",\"Parameters\":{\"Text\":\"Thank you for calling. All calls may be monitored for quality assurance.\"},\"Transitions\":{\"NextAction\":\"f785273b-e449-4b0e-87dc-10c02a2ea11a\",\"Errors\":[],\"Conditions\":[]},\"Type\":\"MessageParticipant\"},{\"Identifier\":\"0b20602c-1008-4f55-b415-6a39a2624634\",\"Parameters\":{\"Attributes\":{\"error_desc\":\"trigger function failed\",\"sfdc-RTT_flag__c\":\"0\",\"process_error\":\"true\"}},\"Transitions\":{\"NextAction\":\"afb3e3e1-3740-48d9-9588-1cdb3c4720bf\",\"Errors\":[{\"NextAction\":\"afb3e3e1-3740-48d9-9588-1cdb3c4720bf\",\"ErrorType\":\"NoMatchingError\"}],\"Conditions\":[]},\"Type\":\"UpdateContactAttributes\"},{\"Identifier\":\"f785273b-e449-4b0e-87dc-10c02a2ea11a\",\"Parameters\":{\"ComparisonValue\":\"$.Attributes.sfdc-RTT_flag__c\"},\"Transitions\":{\"NextAction\":\"afb3e3e1-3740-48d9-9588-1cdb3c4720bf\",\"Errors\":[{\"NextAction\":\"afb3e3e1-3740-48d9-9588-1cdb3c4720bf\",\"ErrorType\":\"NoMatchingCondition\"}],\"Conditions\":[{\"NextAction\":\"bfd1aa01-f94a-4f57-9e4a-30a92180be6c\",\"Condition\":{\"Operator\":\"Equals\",\"Operands\":[\"1\"]}}]},\"Type\":\"Compare\"},{\"Identifier\":\"bfd1aa01-f94a-4f57-9e4a-30a92180be6c\",\"Parameters\":{\"LambdaFunctionARN\":\"%%KVS_CONSUMER_TRIGGER_ARN%%\",\"InvocationTimeLimitSeconds\":\"3\"},\"Transitions\":{\"NextAction\":\"afb3e3e1-3740-48d9-9588-1cdb3c4720bf\",\"Errors\":[{\"NextAction\":\"0b20602c-1008-4f55-b415-6a39a2624634\",\"ErrorType\":\"NoMatchingError\"}],\"Conditions\":[]},\"Type\":\"InvokeLambdaFunction\"},{\"Identifier\":\"283ba344-b7f8-4493-bddd-a6d243b14ba8\",\"Parameters\":{\"Attributes\":{\"voiceCallId\":\"$.External.voiceCallId\"}},\"Transitions\":{\"NextAction\":\"a36f4066-a2a9-4c0e-8047-9cdb428ea4e9\",\"Errors\":[{\"NextAction\":\"38305b2c-ffde-4811-9c77-28971cf722fc\",\"ErrorType\":\"NoMatchingError\"}],\"Conditions\":[]},\"Type\":\"UpdateContactAttributes\"},{\"Identifier\":\"afb3e3e1-3740-48d9-9588-1cdb3c4720bf\",\"Parameters\":{\"LoopCount\":\"2\"},\"Transitions\":{\"NextAction\":\"48e75255-35a6-49e7-9038-7a76525e9227\",\"Errors\":[],\"Conditions\":[{\"NextAction\":\"48e75255-35a6-49e7-9038-7a76525e9227\",\"Condition\":{\"Operator\":\"Equals\",\"Operands\":[\"DoneLooping\"]}},{\"NextAction\":\"af89b7be-14c3-40e7-a9ab-643748abe7ec\",\"Condition\":{\"Operator\":\"Equals\",\"Operands\":[\"ContinueLooping\"]}}]},\"Type\":\"Loop\"},{\"Identifier\":\"af89b7be-14c3-40e7-a9ab-643748abe7ec\",\"Parameters\":{\"LambdaFunctionARN\":\"%%INVOKE_TELEPHONY_FUNCTION_ARN%%\",\"InvocationTimeLimitSeconds\":\"3\",\"LambdaInvocationAttributes\":{\"methodName\":\"createVoiceCall\"}},\"Transitions\":{\"NextAction\":\"283ba344-b7f8-4493-bddd-a6d243b14ba8\",\"Errors\":[{\"NextAction\":\"afb3e3e1-3740-48d9-9588-1cdb3c4720bf\",\"ErrorType\":\"NoMatchingError\"}],\"Conditions\":[]},\"Type\":\"InvokeLambdaFunction\"}]}",
    "Tags": {}
  }
}
