{
  "ContactFlow": {
    "Name": "AWS_Sample_SCV_Queue_Transfer",
    "Type": "QUEUE_TRANSFER",
    "Description": "odified from: Sample_SCV_Queue_Transfer - Adds a loop around the Telephony Integration Lambda. Also provides more accurate messaging for different conditions.",
    "Content": "{\"Version\":\"2019-10-30\",\"StartAction\":\"ec805ed6-cf45-43ea-a418-c9641c7ff794\",\"Metadata\":{\"entryPointPosition\":{\"x\":15,\"y\":31},\"snapToGrid\":false,\"ActionMetadata\":{\"90f850c6-f534-4a42-b82f-4f6ab053243a\":{\"position\":{\"x\":537,\"y\":308},\"useDynamic\":false},\"6a106786-bf06-409a-91a1-301374e968e0\":{\"position\":{\"x\":777,\"y\":306}},\"dee37473-7577-43f5-b7dc-d80733f1d1b0\":{\"position\":{\"x\":291,\"y\":309}},\"e93a9427-21bb-47c5-8693-1b72f866b514\":{\"position\":{\"x\":2087.171630859375,\"y\":31.935991287231445},\"useDynamic\":false},\"861b5e68-b2c5-4443-8035-7697f51144b0\":{\"position\":{\"x\":1479,\"y\":31}},\"5babd3fa-99ac-4d97-803f-e2c971784263\":{\"position\":{\"x\":1813,\"y\":428},\"useDynamic\":false},\"2f8d63be-5da8-4540-81c4-8a6fa8af0706\":{\"position\":{\"x\":2361,\"y\":32}},\"aa2e49ed-9349-4240-9fcd-a9fee50e71a4\":{\"position\":{\"x\":1812,\"y\":31},\"useDynamic\":false},\"c9e05d1c-011a-41b0-b03e-57001aee2192\":{\"position\":{\"x\":2089,\"y\":242},\"useDynamic\":false},\"127a3beb-5492-433d-822d-5c5389a52a33\":{\"position\":{\"x\":2664,\"y\":30},\"useDynamic\":false},\"65d255e0-48e0-411c-b38f-393f41dfda67\":{\"position\":{\"x\":2939,\"y\":32},\"useDynamic\":false},\"8cf205f1-d4e9-4503-8958-c5d6cb9d5052\":{\"position\":{\"x\":2637,\"y\":428},\"useDynamic\":false},\"a09f52a9-fb12-4e33-a2c0-32e7ec838096\":{\"position\":{\"x\":2911,\"y\":456}},\"1786d38e-bc73-4772-b947-ca392841a534\":{\"position\":{\"x\":1114,\"y\":33}},\"ec805ed6-cf45-43ea-a418-c9641c7ff794\":{\"position\":{\"x\":233,\"y\":33},\"useDynamic\":false},\"e5d888c7-8d61-4dc9-9be6-8544262819c9\":{\"position\":{\"x\":1007,\"y\":534},\"dynamicMetadata\":{\"methodName\":false},\"useDynamic\":false}}},\"Actions\":[{\"Identifier\":\"90f850c6-f534-4a42-b82f-4f6ab053243a\",\"Parameters\":{\"Text\":\"I'm sorry. We have encountered an error and cannot currently handle your call. Please try back later. We apologize for any inconvenience. Goodbye.\"},\"Transitions\":{\"NextAction\":\"6a106786-bf06-409a-91a1-301374e968e0\",\"Errors\":[],\"Conditions\":[]},\"Type\":\"MessageParticipant\"},{\"Identifier\":\"6a106786-bf06-409a-91a1-301374e968e0\",\"Type\":\"DisconnectParticipant\",\"Parameters\":{},\"Transitions\":{}},{\"Identifier\":\"dee37473-7577-43f5-b7dc-d80733f1d1b0\",\"Parameters\":{\"Attributes\":{\"error_desc\":\"lambda loop fail\",\"process_error\":\"true\"}},\"Transitions\":{\"NextAction\":\"90f850c6-f534-4a42-b82f-4f6ab053243a\",\"Errors\":[{\"NextAction\":\"90f850c6-f534-4a42-b82f-4f6ab053243a\",\"ErrorType\":\"NoMatchingError\"}],\"Conditions\":[]},\"Type\":\"UpdateContactAttributes\"},{\"Identifier\":\"e93a9427-21bb-47c5-8693-1b72f866b514\",\"Parameters\":{\"Text\":\"Transferring you to the appropriate queue. One moment please.\"},\"Transitions\":{\"NextAction\":\"2f8d63be-5da8-4540-81c4-8a6fa8af0706\",\"Errors\":[],\"Conditions\":[]},\"Type\":\"MessageParticipant\"},{\"Identifier\":\"861b5e68-b2c5-4443-8035-7697f51144b0\",\"Parameters\":{},\"Transitions\":{\"NextAction\":\"5babd3fa-99ac-4d97-803f-e2c971784263\",\"Errors\":[{\"NextAction\":\"5babd3fa-99ac-4d97-803f-e2c971784263\",\"ErrorType\":\"NoMatchingError\"}],\"Conditions\":[{\"NextAction\":\"aa2e49ed-9349-4240-9fcd-a9fee50e71a4\",\"Condition\":{\"Operator\":\"Equals\",\"Operands\":[\"True\"]}},{\"NextAction\":\"5babd3fa-99ac-4d97-803f-e2c971784263\",\"Condition\":{\"Operator\":\"Equals\",\"Operands\":[\"False\"]}}]},\"Type\":\"CheckHoursOfOperation\"},{\"Identifier\":\"5babd3fa-99ac-4d97-803f-e2c971784263\",\"Parameters\":{\"Text\":\"The department you are trying to reach is not currently open. Please try your call again later.\"},\"Transitions\":{\"NextAction\":\"8cf205f1-d4e9-4503-8958-c5d6cb9d5052\",\"Errors\":[],\"Conditions\":[]},\"Type\":\"MessageParticipant\"},{\"Identifier\":\"2f8d63be-5da8-4540-81c4-8a6fa8af0706\",\"Parameters\":{\"RecordingBehavior\":{\"RecordedParticipants\":[\"Agent\",\"Customer\"]}},\"Transitions\":{\"NextAction\":\"127a3beb-5492-433d-822d-5c5389a52a33\",\"Errors\":[],\"Conditions\":[]},\"Type\":\"UpdateContactRecordingBehavior\"},{\"Identifier\":\"aa2e49ed-9349-4240-9fcd-a9fee50e71a4\",\"Parameters\":{\"MetricType\":\"NumberOfAgentsStaffed\"},\"Transitions\":{\"NextAction\":\"5babd3fa-99ac-4d97-803f-e2c971784263\",\"Errors\":[{\"NextAction\":\"5babd3fa-99ac-4d97-803f-e2c971784263\",\"ErrorType\":\"NoMatchingError\"},{\"NextAction\":\"c9e05d1c-011a-41b0-b03e-57001aee2192\",\"ErrorType\":\"NoMatchingCondition\"}],\"Conditions\":[{\"NextAction\":\"e93a9427-21bb-47c5-8693-1b72f866b514\",\"Condition\":{\"Operator\":\"NumberGreaterThan\",\"Operands\":[\"0\"]}}]},\"Type\":\"CheckMetricData\"},{\"Identifier\":\"c9e05d1c-011a-41b0-b03e-57001aee2192\",\"Parameters\":{\"Text\":\"No agents are available to take your call. Please try again at a later time. We apologize for the inconvenience.\"},\"Transitions\":{\"NextAction\":\"8cf205f1-d4e9-4503-8958-c5d6cb9d5052\",\"Errors\":[],\"Conditions\":[]},\"Type\":\"MessageParticipant\"},{\"Identifier\":\"127a3beb-5492-433d-822d-5c5389a52a33\",\"Transitions\":{\"NextAction\":\"c9e05d1c-011a-41b0-b03e-57001aee2192\",\"Errors\":[{\"NextAction\":\"c9e05d1c-011a-41b0-b03e-57001aee2192\",\"ErrorType\":\"NoMatchingError\"},{\"NextAction\":\"65d255e0-48e0-411c-b38f-393f41dfda67\",\"ErrorType\":\"QueueAtCapacity\"}],\"Conditions\":[]},\"Type\":\"TransferContactToQueue\"},{\"Identifier\":\"65d255e0-48e0-411c-b38f-393f41dfda67\",\"Parameters\":{\"Text\":\"We are experiencing a higher than normal volume of calls and cannot currently assist you in a timely manner. Please hang up and try again later. We apologize for the inconvenience.\"},\"Transitions\":{\"NextAction\":\"8cf205f1-d4e9-4503-8958-c5d6cb9d5052\",\"Errors\":[],\"Conditions\":[]},\"Type\":\"MessageParticipant\"},{\"Identifier\":\"8cf205f1-d4e9-4503-8958-c5d6cb9d5052\",\"Parameters\":{\"Text\":\"Goodbye.\"},\"Transitions\":{\"NextAction\":\"a09f52a9-fb12-4e33-a2c0-32e7ec838096\",\"Errors\":[],\"Conditions\":[]},\"Type\":\"MessageParticipant\"},{\"Identifier\":\"a09f52a9-fb12-4e33-a2c0-32e7ec838096\",\"Type\":\"DisconnectParticipant\",\"Parameters\":{},\"Transitions\":{}},{\"Identifier\":\"1786d38e-bc73-4772-b947-ca392841a534\",\"Parameters\":{\"Attributes\":{\"voiceCallId\":\"$.External.voiceCallId\"}},\"Transitions\":{\"NextAction\":\"861b5e68-b2c5-4443-8035-7697f51144b0\",\"Errors\":[{\"NextAction\":\"861b5e68-b2c5-4443-8035-7697f51144b0\",\"ErrorType\":\"NoMatchingError\"}],\"Conditions\":[]},\"Type\":\"UpdateContactAttributes\"},{\"Identifier\":\"ec805ed6-cf45-43ea-a418-c9641c7ff794\",\"Parameters\":{\"LoopCount\":\"2\"},\"Transitions\":{\"NextAction\":\"dee37473-7577-43f5-b7dc-d80733f1d1b0\",\"Errors\":[],\"Conditions\":[{\"NextAction\":\"dee37473-7577-43f5-b7dc-d80733f1d1b0\",\"Condition\":{\"Operator\":\"Equals\",\"Operands\":[\"DoneLooping\"]}},{\"NextAction\":\"e5d888c7-8d61-4dc9-9be6-8544262819c9\",\"Condition\":{\"Operator\":\"Equals\",\"Operands\":[\"ContinueLooping\"]}}]},\"Type\":\"Loop\"},{\"Identifier\":\"e5d888c7-8d61-4dc9-9be6-8544262819c9\",\"Parameters\":{\"LambdaFunctionARN\":\"%%INVOKE_TELEPHONY_FUNCTION_ARN%%\",\"InvocationTimeLimitSeconds\":\"3\",\"LambdaInvocationAttributes\":{\"methodName\":\"createVoiceCall\"}},\"Transitions\":{\"NextAction\":\"1786d38e-bc73-4772-b947-ca392841a534\",\"Errors\":[{\"NextAction\":\"ec805ed6-cf45-43ea-a418-c9641c7ff794\",\"ErrorType\":\"NoMatchingError\"}],\"Conditions\":[]},\"Type\":\"InvokeLambdaFunction\"}]}",
    "Tags": {}
  }
}
